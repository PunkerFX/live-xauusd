<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live XAUUSD Analysis</title>
    <script src="https://unpkg.com/@tradingview/charting-library@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #tradingview_chart {
            height: 600px;
            width: 100%;
            margin: 20px 0;
        }
        .ai-comments, .calendar, .alerts {
            margin: 20px 0;
        }
        h3 {
            color: #333;
        }
        ul {
            list-style-type: none;
            padding-left: 0;
        }
    </style>
</head>
<body>

    <div id="tradingview_chart"></div>
    <div id="ai_comments" class="ai-comments">
        <h3>AI Insights</h3>
        <p id="ai_analysis">Loading insights...</p>
    </div>
    <div id="economic_calendar" class="calendar">
        <h3>Economic Calendar</h3>
        <ul id="calendar_list"></ul>
    </div>
    <div id="alerts" class="alerts">
        <h3>Alerts</h3>
        <ul id="alert_list"></ul>
    </div>

    <script>
        // Configuração da API Alpha Vantage para XAUUSD
        const ALPHA_VANTAGE_API_KEY = '063169H1FSHUHWA2';  // Substitua com sua chave da Alpha Vantage
        const XAUUSD_URL = `https://www.alphavantage.co/query?function=TIME_SERIES_INTRADAY&symbol=XAUUSD&interval=15min&apikey=${ALPHA_VANTAGE_API_KEY}`;

        // Função para obter dados do XAUUSD e enviar para o TradingView
        function getXAUUSDData() {
            axios.get(XAUUSD_URL)
                .then(response => {
                    const data = response.data['Time Series (15min)'];
                    updateChart(data);
                })
                .catch(error => {
                    console.error("Error fetching data:", error);
                });
        }

        // Função para configurar o gráfico do TradingView
        function updateChart(data) {
            new TradingView.widget({
                container_id: "tradingview_chart",
                autosize: true,
                symbol: "XAUUSD",
                interval: "15",
                timezone: "Etc/UTC",
                theme: "light",
                style: "1", // Candlestick chart
                locale: "en",
                toolbar_bg: "#f1f3f6",
                studies: ["RSI", "MACD"],
                overrides: {
                    "volume.volumeColor.positive": "#00FF00",
                    "volume.volumeColor.negative": "#FF0000",
                }
            });

            // Exemplo de adicionar zonas de suporte e resistência diretamente no gráfico
            const supportResistanceZones = [
                { price: 1920, label: "Support Zone", color: "green" },
                { price: 1950, label: "Resistance Zone", color: "red" }
            ];

            supportResistanceZones.forEach(zone => {
                // Adiciona linhas no gráfico do TradingView
                // Este é um exemplo simples; você pode adicionar mais funcionalidades como price levels
                console.log(`Adding ${zone.label} at ${zone.price}`);
            });
        }

        // Função para obter os eventos econômicos e exibir
        function getEconomicCalendar() {
            const calendarUrl = "https://api.investing.com/api/marketdata/1.0/economic-calendar";  // URL da API para o calendário econômico
            axios.get(calendarUrl)
                .then(response => {
                    const events = response.data.events;
                    const eventList = document.getElementById("calendar_list");
                    events.forEach(event => {
                        const li = document.createElement("li");
                        li.textContent = `${event.date} - ${event.event} - Impact: ${event.impact}`;
                        eventList.appendChild(li);
                    });
                })
                .catch(error => {
                    console.error("Error fetching economic calendar:", error);
                });
        }

        // Função para exibir alertas baseados em notícias e dados econômicos
        function displayAIInsights() {
            const aiComments = document.getElementById("ai_analysis");

            // Simulação de uma análise de AI
            aiComments.textContent = "The current economic situation in the US suggests a potential price increase in XAUUSD as inflation rates remain high. Watch for resistance at $1950 and support at $1920.";
        }

        // Função para alertar sobre eventos de mercado
        function setAlerts() {
            const alertList = document.getElementById("alert_list");

            const alert = document.createElement("li");
            alert.textContent = "Alert: US GDP Report in 1 hour. This could impact XAUUSD.";
            alertList.appendChild(alert);
        }

        // Iniciar todas as funções
        function init() {
            getXAUUSDData();
            getEconomicCalendar();
            displayAIInsights();
            setAlerts();
        }

        // Chamar a função de inicialização
        init();
    </script>

</body>
</html>
